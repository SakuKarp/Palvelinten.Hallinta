h4 Demonit
# x) Lue ja tiivistä.

Karvinen 2023: Salt Vagrant - automatically provision one master and two slaves
- Hakemiston luonti
- Tiedoston muokkaaminen
- catti komento tarkastamiseen

Salt contributors: Salt overview

- YAMLin perussäännöt jotka liittyvät salttiin
- Kolme perus elementtiä : scalars, lists, dictionaries
- Järjestely ja sisennys

Salt contributors: Salt states

- Tilojen luomiseen käytettävät moduulit sekä toiminnot
- status check
- saltin esimerkki rakenteet
- saltin tree
- top.sls tiedoston rakenteen ja sen määrittäminen kohdejoukoille


# a) Hello SLS! Tee Hei maailma -tila kirjoittamalla se tekstitiedostoon, esim /srv/salt/hello/init.sls.

Alotin tekemällä https://terokarvinen.com/2023/salt-vagrant/ ohjeiden mukaan yhden masterin ja 2 slavea. Tämän jälkeen tein 

    sudo mkdir -p /srv/salt/hello
    sudoedit /srv/salt/hello/init.sls
    sudo salt '*' state.apply hello

Lisäsin init.sls tiedostoon
/tmp/hello-world:
  file.managed

state applyllä näkyy että se loi orjille hello-world tiedoston.
    
![image](https://github.com/SakuKarp/Palvelinten.Hallinta/assets/148875105/234417e1-eb8b-414c-bbd3-ef63d7f4c08d)



# b) Top. Tee top.sls niin, että tilat ajetaan automaattisesti, esim komennolla "sudo salt '*' state.apply".

Aloitin tekemällä top.sls tiedoston

    sudoedit /srv/salt/top.sls

lisäsin sinne tekstin mikä näkyy kuvassa

![image](https://github.com/SakuKarp/Palvelinten.Hallinta/assets/148875105/3cb4745b-3298-4672-b7e0-d9fe9ae18116)



    
    cat /srv/salt/top.sls

![image](https://github.com/SakuKarp/Palvelinten.Hallinta/assets/148875105/e2b84f49-64b4-4ab8-a8d0-2a5085047e8d)


# c) Apache. Asenna Apache, korvaa sen testisivu ja varmista, että demoni käynnistyy.

Ensin käsin, vasta sitten automaattisesti.
Kirjoita tila sls-tiedostoon.
pkg-file-service
Tässä ei tarvita service:ssä watch, koska index.html ei ole asetustiedosto

# d) SSHouto. Lisää uusi portti, jossa SSHd kuuntelee.

Tämä tehtävä on helpointa tehdä tavallisella virtuaalikoneella, jota Vagrant ei ohjaa.
Löydät oikean asetuksen katsomalla SSH:n asetustiedostoa
Nyt tarvitaan service-watch, jotta demoni käynnistetään uudelleen, jos asetustiedosto muuttuu masterilla




## References
https://terokarvinen.com/2023/salt-vagrant/#infra-as-code---your-wishes-as-a-text-file
https://terokarvinen.com/2023/salt-vagrant/
https://terokarvinen.com/2023/configuration-management-2023-autumn/
